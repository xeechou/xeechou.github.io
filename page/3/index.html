
<!doctype html>
<html lang="en">
  <head>
	<meta name="generator" content="Hugo 0.147.1"><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

    <title>Insaturé</title>

    <meta name="HandheldFriendly" content="true" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    
    <link rel="stylesheet" href="/css/style.min.ce29cd890387a95acecacde4c07420a4b0e2304b69c6e2ee0ab55af1637a62cd.css" integrity="sha256-zinNiQOHqVrOys3kwHQgpLDiMEtpxuLuCrVa8WN6Ys0=" />
    
    
      
    
    
    
    <script src="/js/qrcode.min.js"></script>

  </head>
  <body class="home-template">
    

<nav id="menu">
  <a class="close-button">Close</a>
  <div class="nav-wrapper">
    <p class="nav-label">Menu</p>
    <ul>
      
      
        <li class="nav-about-me" role="presentation">
          <a href="/about/">About Me</a>
        </li>
      
        <li class="nav-emacs-config" role="presentation">
          <a href="/emacs-config/">Emacs Config</a>
        </li>
      
        <li class="nav-rss" role="presentation">
          <a href="/index.xml">RSS</a>
        </li>
      
        <li class="nav-scripts" role="presentation">
          <a href="/gmscripts/">Scripts</a>
        </li>
      
      
      
    </ul>
  </div>
</nav>


    <section id="wrapper">
      <a class="hidden-close"></a>

      


<header id="blog-header" class="has-cover">
  <div class="inner">
    
<nav id="navigation">
  
    
  
  
  <span id="menu-button" class="nav-button">
    <a class="menu-button">
      <i class="icon-menu"></i>
      Menu
    </a>
  </span>
  
</nav>

    <h1 class="blog-name">
      <a href="/">Insaturé</a>
    </h1>
    
    
      <div class="blog-cover cover" style="background-image: url('http://localhost:1313/imgs/home-bg.jpg');"></div>
    
</header>

<div id="index" class="container">
  <main class="content" role="main">
    

<div class="extra-pagination">
  

<nav class="pagination" role="pagination">
  <div class="inner">
    
      <a class="pagination-next" href="/page/2/">
        <i class="ic ic-arrow-left"></i>
        <span class="pagination-label">Newer Posts</span>
      </a>
    
    <span class="pagination-info">Page 3 of 4</span>
    
      <a class="pagination-prev" href="/page/4/">
        <span class="pagination-label">Older Posts</span>
        <i class="ic ic-arrow-right"></i>
      </a>
    
    <div class="clear"></div>
  </div>
</nav>

</div>



  <article class="post">
    <div class="inner">
      <header class="post-header">
          <h2 class="post-title">
            <a href="/posts/jan-update-2021/">Jan 2021 Status Update</a>
          </h2>
          <span class="post-meta">
            
            
              
                
                <a href="http://localhost:1313/tags/journal">Journal</a>
              
              |
            
            <time datetime="2021-01-24">24 Jan 2021</time>
          </span>
          <div class="clear"></div>
      </header>

      <section class="post-excerpt">
        <p>Folks, the Magical year of 2020 is behind us, and it wasn&rsquo;t a happy new chapter
waiting us. Man, I still couldn&rsquo;t believe, once per 100 years, why it was us
who have to face the coronavirus. Now I take a good look of my 2020, I went
from trying to submit a xcbcommon handling patch to weston to writing a full
wayland compositor from scratch. It was not my plan!!! Taiwins should have
being a rather simple application on top of the libweston, the so called
&ldquo;reference compositor &ldquo;, but libweston cannot change keyboard layout once
launching, nor it can support cloning output, there are new bugs when you
digging deep. The worst is that it breaks the library into different shared
modules, and changes lib location every release. It was like it really does not
want to link to it. The codebase was old and long, it was difficult to make a
change and really difficult to get libweston taking a patch. Then there is the
wlroots. If it was released half year earlier Taiwins would probably sit on top
of that. But, screw it. I am doing it myself.</p>
      </section>
    </div>
  </article>
  


  <article class="post">
    <div class="inner">
      <header class="post-header">
          <h2 class="post-title">
            <a href="/posts/drm-backend-ii/">Working with libdrm, buffer allocation</a>
          </h2>
          <span class="post-meta">
            
            
              
                
                <a href="http://localhost:1313/tags/linux">linux</a>
              
                
                <a href="http://localhost:1313/tags/wayland">wayland</a>
              
              |
            
            <time datetime="2020-12-07">07 Dec 2020</time>
          </span>
          <div class="clear"></div>
      </header>

      <section class="post-excerpt">
        <p>In the <a href="%7Bfilename%7D/drm-backend.md">first blog of libdrm</a>, we went through the
repainting loop using the libdrm. Now we move on to the topic of
framebuffers. A framebuffer is a piece of memory (could be on main memory or on
GPU) for repainting every frame. It is like a canvas, represents what you would
finally see on screen. Framebuffer is already a familiar concept to rendering
programmers, in <strong>OpenGL</strong>, We have <code>GL_FRAMEBUFFER_0</code> for presenting the
surface, additional framebuffers for roles like G-Buffer and
post-processing. In GPU programming, framebuffer is also a broader concept,
&ldquo;abstraction of a collection of attachments&rdquo;, the underlining attachments
corresponds to actual pieces of memory we talk about here.</p>
      </section>
    </div>
  </article>
  


  <article class="post">
    <div class="inner">
      <header class="post-header">
          <h2 class="post-title">
            <a href="/posts/drm-backend/">Working with libdrm, repainting timeline</a>
          </h2>
          <span class="post-meta">
            
            
              
                
                <a href="http://localhost:1313/tags/linux">linux</a>
              
              |
            
            <time datetime="2020-11-13">13 Nov 2020</time>
          </span>
          <div class="clear"></div>
      </header>

      <section class="post-excerpt">
        <p>As the taiwins project finished with X11/Wayland backend rigging. Now I am fully
on the libdrm backend development, dealing with hardwares directly. This backend
requires 200 percent my energy to tame the complexity.</p>
<p>Like other backends, libdrm also needs to provide two resources, <em>input</em> and
<em>output</em>. Backends like nested wayland backend or X11 backend, the <em>output</em>
device are the windows created by ourselves (or by the user). Meaning we can
create it or destroy it as we please. As for libdrm, those are provided by the
OS. An <em>output</em> in libdrm&rsquo;s terminology, is called connector. We query and
change the connectors state by <code>drmModeGet*</code> functions. Then later set the
hardware states by <code>drmModeSet*</code> or the new atomic API. It may sound simple but
actually, for displaying images on the screen using the <em>libdrm</em> mechanism, it
takes quite a few components, working together, to achieve the goal. We uses
<code>drmMode*</code> routines for
<a href="https://01.org/linuxgraphics/gfx-docs/drm/gpu/drm-kms.html">kernel-modesetting</a>;
libgbm for framebuffer allocation; OpenGL or Vulkan for rendering. If done
right, you would get tear-free images on your screen constant refresh rate. But
should anything goes wrong, you probably end up with a black screen.</p>
      </section>
    </div>
  </article>
  


  <article class="post">
    <div class="inner">
      <header class="post-header">
          <h2 class="post-title">
            <a href="/posts/aug-update-2020/">August 2020 Status Update</a>
          </h2>
          <span class="post-meta">
            
            
              
                
                <a href="http://localhost:1313/tags/journal">Journal</a>
              
              |
            
            <time datetime="2020-08-22">22 Aug 2020</time>
          </span>
          <div class="clear"></div>
      </header>

      <section class="post-excerpt">
        <p>It is a sunny day, somehow I got up early this morning. The cool, chilling
breath of air reminded me we are at the tail of the summer. It felt so strange,
this summer was like it was never here. Hiking, go swimming, taking a trips and
night outs. all those experiences for a normal summer I would do, they are all
absent, hope I don&rsquo;t regret too much for crunching code at home all these
months. It was a tough year actually, I was determined to push Taiwins to a
usable state, it has been stressful. Every time I look at the pile of the TODO
list, a sentiment of endless development and desperate hit me hard like a heart
attack. I had to work <strong>a lot</strong> to stay healthy.</p>
      </section>
    </div>
  </article>
  


  <article class="post">
    <div class="inner">
      <header class="post-header">
          <h2 class="post-title">
            <a href="/posts/july-update-2020/">July 2020 Status Update</a>
          </h2>
          <span class="post-meta">
            
            
              
                
                <a href="http://localhost:1313/tags/journal">Journal</a>
              
              |
            
            <time datetime="2020-07-18">18 Jul 2020</time>
          </span>
          <div class="clear"></div>
      </header>

      <section class="post-excerpt">
        <p>July, the hottest month in Montreal every year. The heat wave rushes to you when
you walk outside makes you wondering if you are in some tropical island, it sure
doesn&rsquo;t look like living at 45 latitde northen hemisphere. Last month was a
rapid leap towards wayland objects implementations and now I just hitted the
wall of <code>xdg-shell</code> protocol. Today I&rsquo;d like to talk about what it is like to
implement a wayland protocol.</p>
      </section>
    </div>
  </article>
  


  <article class="post">
    <div class="inner">
      <header class="post-header">
          <h2 class="post-title">
            <a href="/posts/june-update/">June 2020 Status Update</a>
          </h2>
          <span class="post-meta">
            
            
              
                
                <a href="http://localhost:1313/tags/journal">Journal</a>
              
              |
            
            <time datetime="2020-07-06">06 Jul 2020</time>
          </span>
          <div class="clear"></div>
      </header>

      <section class="post-excerpt">
        <p>Montréal is hotter than ever in this month, under the broiling sun, it was an
exhausting quarantine. The first <a href="/blog/busy-in-quarantine">month</a> I
remeber I was feeling fortunate I got this aleatory chance for advancement of
<em>taiwins</em> in this global pandemic, right now all I felt was the painful
experience converting all the Taiwins server code away from
libweston. Implementating of server side wayland objects was indeed unpleasant
experience. Without libweston, I have to implement every little thing and get it
right, even the basics 2D homogenous matrix operations for coordinates
transformations. Just a days I ago I discovered my mistakenly used rotations in
the &ldquo;Y-up&rdquo; coordinate system (like OpenGL) in the &ldquo;Y-down&rdquo; coordinate sytem
(like Wayland protocol). The good news was that I did not give up, it seemed I
overcame one difficulties after another, now at least I can paint my taiwins
shell objects using a primitive renderer. In the end, hopefully I will end-up
with a working and cleaner compositor library than <em>libweston</em>. This is
certainly an encouraging news as I used to think a compositor library was not
possible to finish with only two hands.</p>
      </section>
    </div>
  </article>
  


  <article class="post">
    <div class="inner">
      <header class="post-header">
          <h2 class="post-title">
            <a href="/posts/weston-vs-wlroots/">Libweston vs Wlroots</a>
          </h2>
          <span class="post-meta">
            
            
              
                
                <a href="http://localhost:1313/tags/wayland">wayland</a>
              
              |
            
            <time datetime="2020-06-20">20 Jun 2020</time>
          </span>
          <div class="clear"></div>
      </header>

      <section class="post-excerpt">
        <p>You need a wayland compositor library to create a wayland server. Wayland is a
protocol, itself, cannot do much, long time ago I used to think the server-side
<code>wl_resource</code> represents some structure you can operate on, well it turned out
all you do with it is handling messages between client and server. All the logic
you need to implement yourself.</p>
<p>There were a few attempts to wayland compositing library created. The first
sucessful one is <a href="https://github.com/Cloudef/wlc">wlc</a>. I think its existence is
that <a href="https://github.com/wayland-project/weston">weston</a> (the twin of the
wayland project, now maintained by Pekka Paalanen). was a monolith application
for a long time. Weston looks pretty and quite fast and beautiful but not very
useful to anyone else. The developers maybe realized that they want to get more
people to use weston, so they managed to strip <strong>libweston</strong> out of weston
itself. It was a good attempt, although I doubt their true intention was to
creating a reusable compositing library. Nonetheless, to some extent, it helped
the birth of the third library by Drew Devault, the
<a href="https://github.com/swaywm/wlroots">wlroots</a>.</p>
      </section>
    </div>
  </article>
  


  <article class="post">
    <div class="inner">
      <header class="post-header">
          <h2 class="post-title">
            <a href="/posts/data-device/">wl_data_device</a>
          </h2>
          <span class="post-meta">
            
            
              
                
                <a href="http://localhost:1313/tags/wayland">wayland</a>
              
              |
            
            <time datetime="2020-06-12">12 Jun 2020</time>
          </span>
          <div class="clear"></div>
      </header>

      <section class="post-excerpt">
        <p><code>wl_data_device</code> interface in the base wayland protocol is the most complex one,
in my opinion, <em>wayland.xml</em> explains it fairly well, but every pieces are
scattered in the file, here I serialize it together, give you quick run through.</p>
<p>In brief, data device in wayland consists of four interfaces: The first is
<code>wl_data_device_manager</code>, it is the global. The second is <code>wl_data_device</code>,
can be created from <code>wl_data_device_manager</code> for a given seat, it is used to
set selection(ctrl-c ctrl-v) and drag-n-drop. The 3rd is <code>wl_data_source</code>,
also created from <code>wl_data_device_manager</code>, this source will be either a
selection source or drag-n-drop source. The last is <code>wl_data_offer</code>, which is
used for copying data from <code>wl_data_source</code>.</p>
      </section>
    </div>
  </article>
  


  <article class="post">
    <div class="inner">
      <header class="post-header">
          <h2 class="post-title">
            <a href="/posts/may-update/">May 2020 Status Update</a>
          </h2>
          <span class="post-meta">
            
            
              
                
                <a href="http://localhost:1313/tags/journal">Journal</a>
              
              |
            
            <time datetime="2020-05-16">16 May 2020</time>
          </span>
          <div class="clear"></div>
      </header>

      <section class="post-excerpt">
        <p>Forcing a monthly blog update seems to be a good idea, giving myself a reason to
keep paying for this Domain. Also, I don&rsquo;t usually has a topic to address
specifically, a monthly update can fill this role. Anyway, time passes rapidly
in quarantine my friends. I hope a few years forward when I look back at this
moment, I would not feel I wasted so much time. I don&rsquo;t actually feel I made
much progress through this month. I would say, I am digging into my memory right
now, it is hard to recall much in detail. yeah, that is life in quarantine,
&ldquo;stagnation&rdquo;, like the blackwater.</p>
      </section>
    </div>
  </article>
  


  <article class="post">
    <div class="inner">
      <header class="post-header">
          <h2 class="post-title">
            <a href="/posts/busy-in-quarantine/">Busy in quarantine</a>
          </h2>
          <span class="post-meta">
            
            
              
                
                <a href="http://localhost:1313/tags/journal">Journal</a>
              
              |
            
            <time datetime="2020-04-07">07 Apr 2020</time>
          </span>
          <div class="clear"></div>
      </header>

      <section class="post-excerpt">
        <p>I update this blog less frequent than once per year, which sometimes makes me
question why do I keep paying for this site. Be able to update blogs is always
my pursuit, unfortunately there were always more code to write. It has been more
than one year, last time I was still on how to MSAA on OpenGL 4, somehow it felt
like a decade ago. The peaceful developing world took an interesting turn. A
long run bull market is killed and NYSE triggered circuit break 4 times in 10
days. People are joking they now have 75% of Warren Buffet&rsquo;s experience. Will
this gonna be the story we told our grand children born after 2020? &ldquo;You know
back in 2020, it was a crazy year&hellip;&rdquo;. We just saw the quarter of it, I am kind
of expecting the crazier in the rest, will it be massive unemployment and a
scary recession will be waiting? This week the market has recovered a bit of its
confidence somehow, despite the Covid-19 cases are surging. A friend used to
tell me, it would be a point where many will be killed by the virus and people
just don&rsquo;t care anymore, looks like the market is at that point.</p>
      </section>
    </div>
  </article>
  




<nav class="pagination" role="pagination">
  <div class="inner">
    
      <a class="pagination-next" href="/page/2/">
        <i class="ic ic-arrow-left"></i>
        <span class="pagination-label">Newer Posts</span>
      </a>
    
    <span class="pagination-info">Page 3 of 4</span>
    
      <a class="pagination-prev" href="/page/4/">
        <span class="pagination-label">Older Posts</span>
        <i class="ic ic-arrow-right"></i>
      </a>
    
    <div class="clear"></div>
  </div>
</nav>


  </main>
</div>



            <footer id="footer">
        <div class="inner">
          <section class="credits">
            <span class="credits-theme">
              
              
              Theme <a href="https://github.com/zutrinken/attila">Attila</a> by <a href="https://zutrinken.com" rel="nofollow">zutrinken</a>
              |
              
              
              Theme <a href="https://github.com/xeechou/hugo-theme-attila">hugo-theme-attila</a> by <a href="https://xeechou.net" rel="nofollow">xeechou</a>
            </span>
            <span class="credits-software">
              
              Published with <a href="https://gohugo.io">Hugo</a>
            </span>
          </section>
        </div>
      </footer>

    </section>

    
    
    
    
    
    
    
    <script src="/js/script.js"></script>

    
    
    
    
  </body>
</html>
